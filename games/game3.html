<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Jeu Fruit Ninja Emoji - OXYGENE GAMES</title>
<style>
  body {
    margin: 0;
    background: #000;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    user-select: none;
    overflow: hidden;
  }
  .game-container {
    position: relative;
    width: 360px;
    height: 80vh;
    max-height: 700px;
    background: #111;
    border-radius: 15px;
    box-shadow: 0 0 25px #0f0;
    overflow: hidden;
  }
  .scoreboard {
    position: absolute;
    top: 10px;
    left: 15px;
    color: #0f0;
    font-weight: bold;
    font-size: 20px;
    text-shadow: 0 0 8px #0f0;
    user-select: none;
  }
  .scoreboard .score,
  .scoreboard .survie {
    margin-bottom: 4px;
  }
  .timer {
    position: absolute;
    top: 10px;
    right: 15px;
    color: #0f0;
    font-weight: bold;
    font-size: 20px;
    text-shadow: 0 0 8px #0f0;
  }
  .emoji {
    position: absolute;
    font-size: 50px;
    user-select: none;
    cursor: pointer;
    touch-action: manipulation;
    will-change: transform, opacity;
    text-shadow: 0 0 5px #0f0;
  }
  .message {
    position: absolute;
    top: 50%;
    left: 50%;
    width: 90%;
    transform: translate(-50%, -50%);
    background: #0f0;
    color: #000;
    padding: 20px 30px;
    border-radius: 15px;
    font-size: 22px;
    font-weight: bold;
    display: none;
    box-shadow: 0 0 25px #0f0;
    text-align: center;
  }
  .button-restart, .button-start {
    margin-top: 15px;
    background: #0f0;
    color: #000;
    border: none;
    padding: 10px 25px;
    font-weight: bold;
    font-size: 18px;
    border-radius: 12px;
    cursor: pointer;
    box-shadow: 0 0 15px #0f0;
    transition: background 0.3s ease;
  }
  .button-restart:hover, .button-start:hover {
    background: #0c0;
  }
  .overlay {
    position: absolute;
    inset: 0;
    background: rgba(0,0,0,0.75);
    display: flex;
    justify-content: center;
    align-items: center;
    border-radius: 15px;
    z-index: 10;
  }
</style>
</head>
<body>

<div class="game-container" tabindex="0">
  <div class="scoreboard">
    <div class="score">Score üî•: <span id="score">0</span></div>
    <div class="survie">Survie ‚ùå: <span id="survie">0</span></div>
  </div>
  <div class="timer">Temps ‚è≥: <span id="timer">45</span>s</div>
  <div class="message" id="message"></div>

  <div class="overlay" id="startOverlay">
    <button class="button-start" id="startBtn">Start</button>
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
<script>
  const emojis = ['‚öΩ', 'üèãÔ∏è', 'ü§æ', 'ü§∏', 'üßó', 'üèÉ', 'ü§º', 'üßò'];
  const gameContainer = document.querySelector('.game-container');
  const scoreEl = document.getElementById('score');
  const survieEl = document.getElementById('survie');
  const timerEl = document.getElementById('timer');
  const messageEl = document.getElementById('message');
  const startOverlay = document.getElementById('startOverlay');
  const startBtn = document.getElementById('startBtn');

  let score = 0;
  let survie = 0;
  let emojiElements = [];
  let gameDuration = 45; // seconds
  let countdownInterval;
  let spawnInterval;
  let gameActive = false;

  function randomInt(min, max) {
    return Math.floor(Math.random() * (max - min + 1)) + min;
  }

  function spawnEmoji() {
    if (!gameActive) return;
    if (emojiElements.length >= 6) return;

    const emoji = document.createElement('div');
    emoji.classList.add('emoji');
    emoji.textContent = emojis[randomInt(0, emojis.length -1)];
    emoji.style.left = randomInt(20, 320) + 'px';
    emoji.style.bottom = '-60px';
    emoji.dataset.cut = "false"; // ÿ≠ÿßŸÑÿ© ÿπÿØŸÖ ÿßŸÑŸÇÿ∑ÿπ ŸÖÿ®ÿØÿ¶ŸäŸãÿß
    gameContainer.appendChild(emoji);
    emojiElements.push(emoji);

    // ÿ≠ÿ±ŸÉÿ© ÿµÿπŸàÿØ ÿßŸÑÿ•ŸäŸÖŸàÿ¨Ÿä ŸÖÿπ ÿ≠ÿ±ŸÉÿ© ÿ£ŸÅŸÇŸäÿ© ÿ™ÿ∞ÿ®ÿ∞ÿ®Ÿäÿ©
    gsap.to(emoji, {
      duration: randomInt(3,5),
      bottom: 800,
      ease: "power1.out",
      onComplete: () => {
        if (gameActive) {
          removeEmoji(emoji);
          survie++;
          updateScoreboard();
        }
      }
    });
    gsap.to(emoji, {
      duration: randomInt(1,3),
      x: "+=30",
      yoyo: true,
      repeat: -1,
      ease: "sine.inOut"
    });

    // ÿπŸÜÿØ ÿßŸÑŸÜŸÇÿ±: ŸÇÿ∑ÿπ Ÿàÿ≥ŸÇŸàÿ∑ ŸÑŸÉŸÜ ŸÑŸÖÿ±ÿ© Ÿàÿßÿ≠ÿØÿ© ŸÅŸÇÿ∑!
    emoji.addEventListener('click', () => {
      if (!gameActive) return;
      if (emoji.dataset.cut === "true") return; // ŸÑÿß ÿ™ŸÉÿ±ÿ± ÿßŸÑŸÇÿ∑ÿπ
      emoji.dataset.cut = "true";

      score++;
      updateScoreboard();
      gsap.killTweensOf(emoji);
      gsap.to(emoji, {
        rotation: randomInt(-90, 90),
        y: "+=100",
        opacity: 0,
        duration: 0.6,
        ease: "power1.in",
        onComplete: () => {
          removeEmoji(emoji);
        }
      });
    });
  }

  function removeEmoji(emoji) {
    if (!emoji) return;
    const index = emojiElements.indexOf(emoji);
    if (index > -1) emojiElements.splice(index, 1);
    emoji.remove();
  }

  function updateScoreboard() {
    scoreEl.textContent = score;
    survieEl.textContent = survie;
  }

  function startGame() {
    score = 0;
    survie = 0;
    gameDuration = 45;
    updateScoreboard();
    timerEl.textContent = gameDuration;
    messageEl.style.display = 'none';
    gameActive = true;
    startOverlay.style.display = 'none';

    countdownInterval = setInterval(() => {
      gameDuration--;
      timerEl.textContent = gameDuration;
      if (gameDuration <= 0) {
        endGame();
      }
    }, 1000);

    spawnInterval = setInterval(spawnEmoji, 700);
  }

  function endGame() {
    gameActive = false;
    clearInterval(countdownInterval);
    clearInterval(spawnInterval);
    emojiElements.forEach(e => e.remove());
    emojiElements = [];

    let diff = score - survie;
    let win = diff > 0;
    let msg = '';

    if(win) {
      msg = `üî• Bravo! Vous avez plus de coup√©s que de survivants (${score} vs ${survie}) üéâ`;
      playConfetti();
      playApplause();
    } else {
      msg = `‚ùå Tu as plus de survivants que de coup√©s (${survie} vs ${score}) üò≠ \nInscrivez-vous √† "OXYGENE GYM" pour am√©liorer votre rapidit√©!`;
      playSadSound();
      playEmojiRain('üò≠');
    }

    messageEl.textContent = msg;
    messageEl.style.display = 'block';

    const restartBtn = document.createElement('button');
    restartBtn.textContent = 'Recommencer';
    restartBtn.classList.add('button-restart');
    restartBtn.onclick = () => {
      messageEl.style.display = 'none';
      startOverlay.style.display = 'flex';
    };
    messageEl.appendChild(document.createElement('br'));
    messageEl.appendChild(restartBtn);
  }

  // ŸÖÿ§ÿ´ÿ±ÿßÿ™ GSAP
  function playConfetti() {
    for(let i=0; i<30; i++) {
      let confetti = document.createElement('div');
      confetti.textContent = 'üéâ';
      confetti.style.position = 'fixed';
      confetti.style.fontSize = `${randomInt(20,40)}px`;
      confetti.style.left = `${randomInt(0, window.innerWidth)}px`;
      confetti.style.top = `-${randomInt(10,100)}px`;
      confetti.style.pointerEvents = 'none';
      document.body.appendChild(confetti);
      gsap.to(confetti, {
        y: window.innerHeight + 100,
        rotation: randomInt(0,360),
        duration: randomInt(2,4),
        ease: "power1.out",
        onComplete: () => confetti.remove()
      });
    }
  }

  function playEmojiRain(emojiChar) {
    for(let i=0; i<30; i++) {
      let rain = document.createElement('div');
      rain.textContent = emojiChar;
      rain.style.position = 'fixed';
      rain.style.fontSize = `${randomInt(20,40)}px`;
      rain.style.left = `${randomInt(0, window.innerWidth)}px`;
      rain.style.top = `-${randomInt(10,100)}px`;
      rain.style.pointerEvents = 'none';
      document.body.appendChild(rain);
      gsap.to(rain, {
        y: window.innerHeight + 100,
        rotation: randomInt(0,360),
        duration: randomInt(2,4),
        ease: "power1.in",
        onComplete: () => rain.remove()
      });
    }
  }

  // ÿßŸÑÿØŸàÿßŸÑ ÿßŸÑŸÅÿßÿ±ÿ∫ÿ© ÿßŸÑŸÖŸÅŸÇŸàÿØÿ©ÿå ÿ™ŸÖ ÿ•ŸÜÿ¥ÿßÿ§Ÿáÿß ŸÑÿ™ÿ¨ŸÜÿ® ÿßŸÑÿ£ÿÆÿ∑ÿßÿ°
  function playApplause() {
    console.log("Play Applause sound");
  }

  function playSadSound() {
    console.log("Play Sad sound");
  }


  startBtn.addEventListener('click', () => {
    emojiElements.forEach(e => e.remove());
    emojiElements = [];
    startGame();
  });

  gameContainer.addEventListener('click', (e) => {
    e.stopPropagation();
  });
</script>
</body>
</html>
